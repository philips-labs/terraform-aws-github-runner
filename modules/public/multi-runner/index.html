
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../runners/">
      
      
        <link rel="next" href="../ami-housekeeper/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Multi Runners - GitHub Runners on AWS</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-multi-runner" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="GitHub Runners on AWS" class="md-header__button md-logo" aria-label="GitHub Runners on AWS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M19.22 4c.28 0 .53 0 .74.05.17 1.39-.02 4.25-3.3 7.53-1.7 1.71-3.73 3.02-6.01 3.89l-2.15-2.1c.92-2.31 2.23-4.34 3.92-6.03C15.18 4.58 17.64 4 19.22 4m0-2c-1.98 0-4.98.69-8.22 3.93-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.38.38.89.61 1.42.61.23 0 .47-.06.7-.15A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61S20.7 2 19.22 2m-4.68 7.46c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GitHub Runners on AWS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Multi Runners
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/github-aws-runners/terraform-aws-github-runner" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-aws-runners/terraform-aws-github-runner
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="GitHub Runners on AWS" class="md-nav__button md-logo" aria-label="GitHub Runners on AWS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27zM5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M19.22 4c.28 0 .53 0 .74.05.17 1.39-.02 4.25-3.3 7.53-1.7 1.71-3.73 3.02-6.01 3.89l-2.15-2.1c.92-2.31 2.23-4.34 3.92-6.03C15.18 4.58 17.64 4 19.22 4m0-2c-1.98 0-4.98.69-8.22 3.93-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.38.38.89.61 1.42.61.23 0 .47-.06.7-.15A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61S20.7 2 19.22 2m-4.68 7.46c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83s-2.05.78-2.83 0m-5.66 7.07-1.41-1.41zM6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22zM2 22h1.41l4.77-4.76-1.42-1.41L2 20.59zm0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76z"/></svg>

    </a>
    GitHub Runners on AWS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/github-aws-runners/terraform-aws-github-runner" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-aws-runners/terraform-aws-github-runner
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runners (main)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Submodules (public)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Submodules (public)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Multi Runners
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Multi Runners
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#matching" class="md-nav__link">
    <span class="md-ellipsis">
      Matching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-catch" class="md-nav__link">
    <span class="md-ellipsis">
      The catch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usages" class="md-nav__link">
    <span class="md-ellipsis">
      Usages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providers" class="md-nav__link">
    <span class="md-ellipsis">
      Providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Inputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ami-housekeeper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AMI Housekeeper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../download-lambda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lambda Downloader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup-iam-permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup IAM permissions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Submodules (internal)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Submodules (internal)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/runners/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Runners
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/runner-binaries-syncer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syncer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/ssm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/webhook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Webhook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../internal/webhook-github-app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update Webhook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/default/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/multi-runner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi Runner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/ephemeral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ephemeral
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/prebuilt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom AMI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/termination-watcher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Termination watcher
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/lambda-download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lambda download
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/permissions-boundary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions boundary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../ami-examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AMI examples
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#matching" class="md-nav__link">
    <span class="md-ellipsis">
      Matching
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-catch" class="md-nav__link">
    <span class="md-ellipsis">
      The catch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usages" class="md-nav__link">
    <span class="md-ellipsis">
      Usages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#providers" class="md-nav__link">
    <span class="md-ellipsis">
      Providers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modules" class="md-nav__link">
    <span class="md-ellipsis">
      Modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    <span class="md-ellipsis">
      Inputs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Outputs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/github-aws-runners/terraform-aws-github-runner/edit/main/docs/modules/public/multi-runner.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="module-multi-runner">Module - Multi runner</h1>
<blockquote>
<p>This module replaces the top-level module to make it easy to create with one deployment multiple type of runners.</p>
</blockquote>
<p>This module creates many runners with a single GitHub app. The module utilizes the internal modules and deploys parts of the stack for each runner defined.</p>
<p>The module takes a configuration as input containing a matcher for the labels. The <a href="https://github-aws-runners.github.io/terraform-aws-github-runner/modules/internal/webhook/">webhook</a> lambda is using the configuration to delegate events based on the labels in the workflow job and sent them to a dedicated queue based on the configuration. Events on each queue are processed by a dedicated lambda per configuration to scale runners.</p>
<p>For each configuration:</p>
<ul>
<li>When enabled, the <a href="https://github-aws-runners.github.io/terraform-aws-github-runner/modules/internal/runner-binaries-syncer/">distribution syncer</a> is deployed for each unique combination of OS and architecture.</li>
<li>For each configuration a queue is created and <a href="https://github-aws-runners.github.io/terraform-aws-github-runner/modules/internal/runners/">runner module</a> is deployed</li>
</ul>
<h2 id="matching">Matching</h2>
<p>Matching of the configuration is done based on the labels specified in labelMatchers configuration. The webhook is processing the <code>workflow_job</code> event and match the labels against the labels specified in labelMatchers configuration in the order of configuration with exact-match true first, followed by all exact matches false.</p>
<h2 id="the-catch">The catch</h2>
<p>Controlling which event is taken up by which runner is not to this module. It is completely done by GitHub. This means when potentially different runners can run the same job there is nothing that can be done to guarantee a certain runner will take up the job.</p>
<p>An example, given you have two runners one with the labels. <code>self-hosted, linux, x64, large</code> and one with the labels <code>self-hosted, linux, x64, small</code>. Once you define a subset of the labels in the workflow, for example <code>self-hosted, linux, x64</code>. Both runners can take the job potentially. You can define to scale one of the runners for the event, but still there is no guarantee that the scaled runner takes the job. The workflow with subset of labels (<code>self-hosted, linux, x64</code>) can take up runner with specific labels (<code>self-hosted, linux, x64, large</code>) and leave the workflow with labels (<code>self-hosted, linux, x64, large</code>) be without the runner.
The only mitigation that is available right now is to use a small pool of runners. Pool instances can also exist for a short amount of time and only created once in x time based on a cron expression.</p>
<p>Jobs not defining all all labels but for example only <code>[self-hosted, linux]</code> could be matched to potentially different runners. The matcher scales the first runner that matches. With the attribute <code>priority</code> the order of matchers can be defined.</p>
<h2 id="usages">Usages</h2>
<p>A complete example is available in the examples, see the <a href="https://github-aws-runners.github.io/terraform-aws-github-runner/examples/">multi-runner example</a> for actual implementation.</p>
<div class="highlight"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="nv">&quot;multi-runner&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;multi-runner&quot;</span>

<span class="w">  </span><span class="nb">github_app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="c1">    # app details</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nb">multi_runner_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;linux-arm&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">matcherConfig</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">labelMatchers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="s2">&quot;self-hosted&quot;, &quot;linux&quot;, &quot;arm64&quot;, &quot;arm&quot;</span><span class="p">]]</span>
<span class="w">        </span><span class="na">exactMatch</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nb">runner_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">runner_os</span><span class="w">                      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;linux&quot;</span>
<span class="w">        </span><span class="na">runner_architecture</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;arm64&quot;</span>
<span class="w">        </span><span class="na">runner_extra_labels</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;arm&quot;</span>
<span class="w">        </span><span class="na">enable_ssm_on_runners</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">        </span><span class="na">instance_types</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;t4g.large&quot;, &quot;c6g.large&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="p">...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="p">...</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;linux-x64&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="err">matcherConfig</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">labelMatchers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="s2">&quot;self-hosted&quot;, &quot;linux&quot;, &quot;x64&quot;</span><span class="p">]]</span>
<span class="w">        </span><span class="na">exactMatch</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="no">false</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="nb">runner_config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="na">runner_os</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;linux&quot;</span>
<span class="w">        </span><span class="na">runner_architecture</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;x64&quot;</span>
<span class="w">        </span><span class="na">instance_types</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;m5ad.large&quot;, &quot;m5a.large&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="na">enable_ephemeral_runners</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="w">        </span><span class="na">delay_webhook_event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">        </span><span class="p">...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="p">...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<!-- BEGIN_TF_DOCS -->
<h2 id="requirements">Requirements</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a name="requirement_terraform"></a> <a href="#requirement_terraform">terraform</a></td>
<td>&gt;= 1.3</td>
</tr>
<tr>
<td><a name="requirement_aws"></a> <a href="#requirement_aws">aws</a></td>
<td>~&gt; 5.77</td>
</tr>
<tr>
<td><a name="requirement_random"></a> <a href="#requirement_random">random</a></td>
<td>~&gt; 3.0</td>
</tr>
</tbody>
</table>
<h2 id="providers">Providers</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a name="provider_aws"></a> <a href="#provider_aws">aws</a></td>
<td>~&gt; 5.77</td>
</tr>
<tr>
<td><a name="provider_random"></a> <a href="#provider_random">random</a></td>
<td>~&gt; 3.0</td>
</tr>
</tbody>
</table>
<h2 id="modules">Modules</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Source</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td><a name="module_ami_housekeeper"></a> <a href="#module_ami_housekeeper">ami_housekeeper</a></td>
<td>../ami-housekeeper</td>
<td>n/a</td>
</tr>
<tr>
<td><a name="module_instance_termination_watcher"></a> <a href="#module_instance_termination_watcher">instance_termination_watcher</a></td>
<td>../termination-watcher</td>
<td>n/a</td>
</tr>
<tr>
<td><a name="module_runner_binaries"></a> <a href="#module_runner_binaries">runner_binaries</a></td>
<td>../runner-binaries-syncer</td>
<td>n/a</td>
</tr>
<tr>
<td><a name="module_runners"></a> <a href="#module_runners">runners</a></td>
<td>../runners</td>
<td>n/a</td>
</tr>
<tr>
<td><a name="module_ssm"></a> <a href="#module_ssm">ssm</a></td>
<td>../ssm</td>
<td>n/a</td>
</tr>
<tr>
<td><a name="module_webhook"></a> <a href="#module_webhook">webhook</a></td>
<td>../webhook</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<h2 id="resources">Resources</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue">aws_sqs_queue.queued_builds</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue">aws_sqs_queue.queued_builds_dlq</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy">aws_sqs_queue_policy.build_queue_dlq_policy</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy">aws_sqs_queue_policy.build_queue_policy</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/string">random_string.random</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document">aws_iam_policy_document.deny_unsecure_transport</a></td>
<td>data source</td>
</tr>
</tbody>
</table>
<h2 id="inputs">Inputs</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Default</th>
<th style="text-align: center;">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td><a name="input_ami_housekeeper_cleanup_config"></a> <a href="#input_ami_housekeeper_cleanup_config">ami_housekeeper_cleanup_config</a></td>
<td>Configuration for AMI cleanup.</td>
<td><pre>object({<br/>    maxItems       = optional(number)<br/>    minimumDaysOld = optional(number)<br/>    amiFilters = optional(list(object({<br/>      Name   = string<br/>      Values = list(string)<br/>    })))<br/>    launchTemplateNames = optional(list(string))<br/>    ssmParameterNames   = optional(list(string))<br/>    dryRun              = optional(bool)<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_memory_size"></a> <a href="#input_ami_housekeeper_lambda_memory_size">ami_housekeeper_lambda_memory_size</a></td>
<td>Memory size linit in MB of the lambda.</td>
<td><code>number</code></td>
<td><code>256</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_s3_key"></a> <a href="#input_ami_housekeeper_lambda_s3_key">ami_housekeeper_lambda_s3_key</a></td>
<td>S3 key for syncer lambda function. Required if using S3 bucket to specify lambdas.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_s3_object_version"></a> <a href="#input_ami_housekeeper_lambda_s3_object_version">ami_housekeeper_lambda_s3_object_version</a></td>
<td>S3 object version for syncer lambda function. Useful if S3 versioning is enabled on source bucket.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_schedule_expression"></a> <a href="#input_ami_housekeeper_lambda_schedule_expression">ami_housekeeper_lambda_schedule_expression</a></td>
<td>Scheduler expression for action runner binary syncer.</td>
<td><code>string</code></td>
<td><code>"cron(11 7 * * ? *)"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_timeout"></a> <a href="#input_ami_housekeeper_lambda_timeout">ami_housekeeper_lambda_timeout</a></td>
<td>Time out of the lambda in seconds.</td>
<td><code>number</code></td>
<td><code>300</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ami_housekeeper_lambda_zip"></a> <a href="#input_ami_housekeeper_lambda_zip">ami_housekeeper_lambda_zip</a></td>
<td>File location of the lambda zip file.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_associate_public_ipv4_address"></a> <a href="#input_associate_public_ipv4_address">associate_public_ipv4_address</a></td>
<td>Associate public IPv4 with the runner. Only tested with IPv4</td>
<td><code>bool</code></td>
<td><code>false</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_aws_partition"></a> <a href="#input_aws_partition">aws_partition</a></td>
<td>(optiona) partition in the arn namespace to use if not 'aws'</td>
<td><code>string</code></td>
<td><code>"aws"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_aws_region"></a> <a href="#input_aws_region">aws_region</a></td>
<td>AWS region.</td>
<td><code>string</code></td>
<td>n/a</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td><a name="input_cloudwatch_config"></a> <a href="#input_cloudwatch_config">cloudwatch_config</a></td>
<td>(optional) Replaces the module default cloudwatch log config. See https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html for details.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_enable_ami_housekeeper"></a> <a href="#input_enable_ami_housekeeper">enable_ami_housekeeper</a></td>
<td>Option to disable the lambda to clean up old AMIs.</td>
<td><code>bool</code></td>
<td><code>false</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_enable_managed_runner_security_group"></a> <a href="#input_enable_managed_runner_security_group">enable_managed_runner_security_group</a></td>
<td>Enabling the default managed security group creation. Unmanaged security groups can be specified via <code>runner_additional_security_group_ids</code>.</td>
<td><code>bool</code></td>
<td><code>true</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_eventbridge"></a> <a href="#input_eventbridge">eventbridge</a></td>
<td>Enable the use of EventBridge by the module. By enabling this feature events will be put on the EventBridge by the webhook instead of directly dispatching to queues for scaling.</td>
<td><pre>object({<br/>    enable        = optional(bool, true)<br/>    accept_events = optional(list(string), [])<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ghes_ssl_verify"></a> <a href="#input_ghes_ssl_verify">ghes_ssl_verify</a></td>
<td>GitHub Enterprise SSL verification. Set to 'false' when custom certificate (chains) is used for GitHub Enterprise Server (insecure).</td>
<td><code>bool</code></td>
<td><code>true</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ghes_url"></a> <a href="#input_ghes_url">ghes_url</a></td>
<td>GitHub Enterprise Server URL. Example: https://github.internal.co - DO NOT SET IF USING PUBLIC GITHUB</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_github_app"></a> <a href="#input_github_app">github_app</a></td>
<td>GitHub app parameters, see your github app. Ensure the key is the base64-encoded <code>.pem</code> file (the output of <code>base64 app.private-key.pem</code>, not the content of <code>private-key.pem</code>).</td>
<td><pre>object({<br/>    key_base64     = string<br/>    id             = string<br/>    webhook_secret = string<br/>  })</pre></td>
<td>n/a</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td><a name="input_instance_profile_path"></a> <a href="#input_instance_profile_path">instance_profile_path</a></td>
<td>The path that will be added to the instance_profile, if not set the environment name will be used.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_instance_termination_watcher"></a> <a href="#input_instance_termination_watcher">instance_termination_watcher</a></td>
<td>Configuration for the spot termination watcher lambda function. This feature is Beta, changes will not trigger a major release as long in beta.<br/><br/><code>enable</code>: Enable or disable the spot termination watcher.<br/><code>memory_size</code>: Memory size linit in MB of the lambda.<br/><code>s3_key</code>: S3 key for syncer lambda function. Required if using S3 bucket to specify lambdas.<br/><code>s3_object_version</code>: S3 object version for syncer lambda function. Useful if S3 versioning is enabled on source bucket.<br/><code>timeout</code>: Time out of the lambda in seconds.<br/><code>zip</code>: File location of the lambda zip file.</td>
<td><pre>object({<br/>    enable = optional(bool, false)<br/>    features = optional(object({<br/>      enable_spot_termination_handler              = optional(bool, true)<br/>      enable_spot_termination_notification_watcher = optional(bool, true)<br/>    }), {})<br/>    memory_size       = optional(number, null)<br/>    s3_key            = optional(string, null)<br/>    s3_object_version = optional(string, null)<br/>    timeout           = optional(number, null)<br/>    zip               = optional(string, null)<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_key_name"></a> <a href="#input_key_name">key_name</a></td>
<td>Key pair name</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_kms_key_arn"></a> <a href="#input_kms_key_arn">kms_key_arn</a></td>
<td>Optional CMK Key ARN to be used for Parameter Store.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_architecture"></a> <a href="#input_lambda_architecture">lambda_architecture</a></td>
<td>AWS Lambda architecture. Lambda functions using Graviton processors ('arm64') tend to have better price/performance than 'x86_64' functions.</td>
<td><code>string</code></td>
<td><code>"arm64"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_principals"></a> <a href="#input_lambda_principals">lambda_principals</a></td>
<td>(Optional) add extra principals to the role created for execution of the lambda, e.g. for local testing.</td>
<td><pre>list(object({<br/>    type        = string<br/>    identifiers = list(string)<br/>  }))</pre></td>
<td><code>[]</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_runtime"></a> <a href="#input_lambda_runtime">lambda_runtime</a></td>
<td>AWS Lambda runtime.</td>
<td><code>string</code></td>
<td><code>"nodejs22.x"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_s3_bucket"></a> <a href="#input_lambda_s3_bucket">lambda_s3_bucket</a></td>
<td>S3 bucket from which to specify lambda functions. This is an alternative to providing local files directly.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_security_group_ids"></a> <a href="#input_lambda_security_group_ids">lambda_security_group_ids</a></td>
<td>List of security group IDs associated with the Lambda function.</td>
<td><code>list(string)</code></td>
<td><code>[]</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_subnet_ids"></a> <a href="#input_lambda_subnet_ids">lambda_subnet_ids</a></td>
<td>List of subnets in which the action runners will be launched, the subnets needs to be subnets in the <code>vpc_id</code>.</td>
<td><code>list(string)</code></td>
<td><code>[]</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_lambda_tags"></a> <a href="#input_lambda_tags">lambda_tags</a></td>
<td>Map of tags that will be added to all the lambda function resources. Note these are additional tags to the default tags.</td>
<td><code>map(string)</code></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_log_level"></a> <a href="#input_log_level">log_level</a></td>
<td>Logging level for lambda logging. Valid values are  'silly', 'trace', 'debug', 'info', 'warn', 'error', 'fatal'.</td>
<td><code>string</code></td>
<td><code>"info"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_logging_kms_key_id"></a> <a href="#input_logging_kms_key_id">logging_kms_key_id</a></td>
<td>Specifies the kms key id to encrypt the logs with</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_logging_retention_in_days"></a> <a href="#input_logging_retention_in_days">logging_retention_in_days</a></td>
<td>Specifies the number of days you want to retain log events for the lambda log group. Possible values are: 0, 1, 3, 5, 7, 14, 30, 60, 90, 120, 150, 180, 365, 400, 545, 731, 1827, and 3653.</td>
<td><code>number</code></td>
<td><code>180</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_matcher_config_parameter_store_tier"></a> <a href="#input_matcher_config_parameter_store_tier">matcher_config_parameter_store_tier</a></td>
<td>The tier of the parameter store for the matcher configuration. Valid values are <code>Standard</code>, and <code>Advanced</code>.</td>
<td><code>string</code></td>
<td><code>"Standard"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_metrics"></a> <a href="#input_metrics">metrics</a></td>
<td>Configuration for metrics created by the module, by default metrics are disabled to avoid additional costs. When metrics are enable all metrics are created unless explicit configured otherwise.</td>
<td><pre>object({<br/>    enable    = optional(bool, false)<br/>    namespace = optional(string, "GitHub Runners")<br/>    metric = optional(object({<br/>      enable_github_app_rate_limit    = optional(bool, true)<br/>      enable_job_retry                = optional(bool, true)<br/>      enable_spot_termination_warning = optional(bool, true)<br/>    }), {})<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_multi_runner_config"></a> <a href="#input_multi_runner_config">multi_runner_config</a></td>
<td>multi_runner_config = {<br/>      runner_config: {<br/>        runner_os: "The EC2 Operating System type to use for action runner instances (linux,windows)."<br/>        runner_architecture: "The platform architecture of the runner instance_type."<br/>        runner_metadata_options: "(Optional) Metadata options for the ec2 runner instances."<br/>        ami_filter: "(Optional) List of maps used to create the AMI filter for the action runner AMI. By default amazon linux 2 is used."<br/>        ami_owners: "(Optional) The list of owners used to select the AMI of action runner instances."<br/>        create_service_linked_role_spot: (Optional) create the serviced linked role for spot instances that is required by the scale-up lambda.<br/>        credit_specification: "(Optional) The credit specification of the runner instance_type. Can be unset, <code>standard</code> or <code>unlimited</code>.<br/>        delay_webhook_event: "The number of seconds the event accepted by the webhook is invisible on the queue before the scale up lambda will receive the event."<br/>        disable_runner_autoupdate: "Disable the auto update of the github runner agent. Be aware there is a grace period of 30 days, see also the <a href="https://github.blog/changelog/2022-02-01-github-actions-self-hosted-runners-can-now-disable-automatic-updates/">GitHub article</a>"<br/>        ebs_optimized: "The EC2 EBS optimized configuration."<br/>        enable_ephemeral_runners: "Enable ephemeral runners, runners will only be used once."<br/>        enable_job_queued_check: "Enables JIT configuration for creating runners instead of registration token based registraton. JIT configuration will only be applied for ephemeral runners. By default JIT confiugration is enabled for ephemeral runners an can be disabled via this override. When running on GHES without support for JIT configuration this variable should be set to true for ephemeral runners."<br/>        enable_on_demand_failover_for_errors: "Enable on-demand failover. For example to fall back to on demand when no spot capacity is available the variable can be set to <code>InsufficientInstanceCapacity</code>. When not defined the default behavior is to retry later."<br/>        enable_organization_runners: "Register runners to organization, instead of repo level"<br/>        enable_runner_binaries_syncer: "Option to disable the lambda to sync GitHub runner distribution, useful when using a pre-build AMI."<br/>        enable_ssm_on_runners: "Enable to allow access the runner instances for debugging purposes via SSM. Note that this adds additional permissions to the runner instances."<br/>        enable_userdata: "Should the userdata script be enabled for the runner. Set this to false if you are using your own prebuilt AMI."<br/>        instance_allocation_strategy: "The allocation strategy for spot instances. AWS recommends to use <code>capacity-optimized</code> however the AWS default is <code>lowest-price</code>."<br/>        instance_max_spot_price: "Max price price for spot intances per hour. This variable will be passed to the create fleet as max spot price for the fleet."<br/>        instance_target_capacity_type: "Default lifecycle used for runner instances, can be either <code>spot</code> or <code>on-demand</code>."<br/>        instance_types: "List of instance types for the action runner. Defaults are based on runner_os (al2023 for linux and Windows Server Core for win)."<br/>        job_queue_retention_in_seconds: "The number of seconds the job is held in the queue before it is purged"<br/>        minimum_running_time_in_minutes: "The time an ec2 action runner should be running at minimum before terminated if not busy."<br/>        pool_runner_owner: "The pool will deploy runners to the GitHub org ID, set this value to the org to which you want the runners deployed. Repo level is not supported."<br/>        runner_additional_security_group_ids: "List of additional security groups IDs to apply to the runner. If added outside the multi_runner_config block, the additional security group(s) will be applied to all runner configs. If added inside the multi_runner_config, the additional security group(s) will be applied to the individual runner."<br/>        runner_as_root: "Run the action runner under the root user. Variable <code>runner_run_as</code> will be ignored."<br/>        runner_boot_time_in_minutes: "The minimum time for an EC2 runner to boot and register as a runner."<br/>        runner_disable_default_labels: "Disable default labels for the runners (os, architecture and <code>self-hosted</code>). If enabled, the runner will only have the extra labels provided in <code>runner_extra_labels</code>. In case you on own start script is used, this configuration parameter needs to be parsed via SSM."<br/>        runner_extra_labels: "Extra (custom) labels for the runners (GitHub). Separate each label by a comma. Labels checks on the webhook can be enforced by setting <code>multi_runner_config.matcherConfig.exactMatch</code>. GitHub read-only labels should not be provided."<br/>        runner_group_name: "Name of the runner group."<br/>        runner_name_prefix: "Prefix for the GitHub runner name."<br/>        runner_run_as: "Run the GitHub actions agent as user."<br/>        runners_maximum_count: "The maximum number of runners that will be created. Setting the variable to <code>-1</code> desiables the maximum check."<br/>        scale_down_schedule_expression: "Scheduler expression to check every x for scale down."<br/>        scale_up_reserved_concurrent_executions: "Amount of reserved concurrent executions for the scale-up lambda function. A value of 0 disables lambda from being triggered and -1 removes any concurrency limitations."<br/>        userdata_template: "Alternative user-data template, replacing the default template. By providing your own user_data you have to take care of installing all required software, including the action runner. Variables userdata_pre/post_install are ignored."<br/>        enable_jit_config "Overwrite the default behavior for JIT configuration. By default JIT configuration is enabled for ephemeral runners and disabled for non-ephemeral runners. In case of GHES check first if the JIT config API is avaialbe. In case you upgradeing from 3.x to 4.x you can set <code>enable_jit_config</code> to <code>false</code> to avoid a breaking change when having your own AMI."<br/>        enable_runner_detailed_monitoring: "Should detailed monitoring be enabled for the runner. Set this to true if you want to use detailed monitoring. See https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html for details."<br/>        enable_cloudwatch_agent: "Enabling the cloudwatch agent on the ec2 runner instances, the runner contains default config. Configuration can be overridden via <code>cloudwatch_config</code>."<br/>        cloudwatch_config: "(optional) Replaces the module default cloudwatch log config. See https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html for details."<br/>        userdata_pre_install: "Script to be ran before the GitHub Actions runner is installed on the EC2 instances"<br/>        userdata_post_install: "Script to be ran after the GitHub Actions runner is installed on the EC2 instances"<br/>        runner_hook_job_started: "Script to be ran in the runner environment at the beginning of every job"<br/>        runner_hook_job_completed: "Script to be ran in the runner environment at the end of every job"<br/>        runner_ec2_tags: "Map of tags that will be added to the launch template instance tag specifications."<br/>        runner_iam_role_managed_policy_arns: "Attach AWS or customer-managed IAM policies (by ARN) to the runner IAM role"<br/>        vpc_id: "The VPC for security groups of the action runners. If not set uses the value of <code>var.vpc_id</code>."<br/>        subnet_ids: "List of subnets in which the action runners will be launched, the subnets needs to be subnets in the <code>vpc_id</code>. If not set, uses the value of <code>var.subnet_ids</code>."<br/>        idle_config: "List of time period that can be defined as cron expression to keep a minimum amount of runners active instead of scaling down to 0. By defining this list you can ensure that in time periods that match the cron expression within 5 seconds a runner is kept idle."<br/>        runner_log_files: "(optional) Replaces the module default cloudwatch log config. See https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html for details."<br/>        block_device_mappings: "The EC2 instance block device configuration. Takes the following keys: <code>device_name</code>, <code>delete_on_termination</code>, <code>volume_type</code>, <code>volume_size</code>, <code>encrypted</code>, <code>iops</code>, <code>throughput</code>, <code>kms_key_id</code>, <code>snapshot_id</code>."<br/>        job_retry: "Experimental! Can be removed / changed without trigger a major release. Configure job retries. The configuration enables job retries (for ephemeral runners). After creating the insances a message will be published to a job retry queue. The job retry check lambda is checking after a delay if the job is queued. If not the message will be published again on the scale-up (build queue). Using this feature can impact the reate limit of the GitHub app."<br/>        pool_config: "The configuration for updating the pool. The <code>pool_size</code> to adjust to by the events triggered by the <code>schedule_expression</code>. For example you can configure a cron expression for week days to adjust the pool to 10 and another expression for the weekend to adjust the pool to 1. Use <code>schedule_expression_timezone</code> to override the schedule time zone (defaults to UTC)."<br/>      }<br/>      matcherConfig: {<br/>        labelMatchers: "The list of list of labels supported by the runner configuration. <code>[[self-hosted, linux, x64, example]]</code>"<br/>        exactMatch: "If set to true all labels in the workflow job must match the GitHub labels (os, architecture and <code>self-hosted</code>). When false if <strong>any</strong> workflow label matches it will trigger the webhook."<br/>        priority: "If set it defines the priority of the matcher, the matcher with the lowest priority will be evaluated first. Default is 999, allowed values 0-999."<br/>      }<br/>      redrive_build_queue: "Set options to attach (optional) a dead letter queue to the build queue, the queue between the webhook and the scale up lambda. You have the following options. 1. Disable by setting <code>enabled</code> to false. 2. Enable by setting <code>enabled</code> to <code>true</code>, <code>maxReceiveCount</code> to a number of max retries."<br/>    }</td>
<td><pre>map(object({<br/>    runner_config = object({<br/>      runner_os           = string<br/>      runner_architecture = string<br/>      runner_metadata_options = optional(map(any), {<br/>        instance_metadata_tags      = "enabled"<br/>        http_endpoint               = "enabled"<br/>        http_tokens                 = "required"<br/>        http_put_response_hop_limit = 1<br/>      })<br/>      ami_filter                              = optional(map(list(string)), { state = ["available"] })<br/>      ami_owners                              = optional(list(string), ["amazon"])<br/>      ami_id_ssm_parameter_name               = optional(string, null)<br/>      ami_kms_key_arn                         = optional(string, "")<br/>      create_service_linked_role_spot         = optional(bool, false)<br/>      credit_specification                    = optional(string, null)<br/>      delay_webhook_event                     = optional(number, 30)<br/>      disable_runner_autoupdate               = optional(bool, false)<br/>      ebs_optimized                           = optional(bool, false)<br/>      enable_ephemeral_runners                = optional(bool, false)<br/>      enable_job_queued_check                 = optional(bool, null)<br/>      enable_on_demand_failover_for_errors    = optional(list(string), [])<br/>      enable_organization_runners             = optional(bool, false)<br/>      enable_runner_binaries_syncer           = optional(bool, true)<br/>      enable_ssm_on_runners                   = optional(bool, false)<br/>      enable_userdata                         = optional(bool, true)<br/>      instance_allocation_strategy            = optional(string, "lowest-price")<br/>      instance_max_spot_price                 = optional(string, null)<br/>      instance_target_capacity_type           = optional(string, "spot")<br/>      instance_types                          = list(string)<br/>      job_queue_retention_in_seconds          = optional(number, 86400)<br/>      minimum_running_time_in_minutes         = optional(number, null)<br/>      pool_runner_owner                       = optional(string, null)<br/>      runner_as_root                          = optional(bool, false)<br/>      runner_boot_time_in_minutes             = optional(number, 5)<br/>      runner_disable_default_labels           = optional(bool, false)<br/>      runner_extra_labels                     = optional(list(string), [])<br/>      runner_group_name                       = optional(string, "Default")<br/>      runner_name_prefix                      = optional(string, "")<br/>      runner_run_as                           = optional(string, "ec2-user")<br/>      runners_maximum_count                   = number<br/>      runner_additional_security_group_ids    = optional(list(string), [])<br/>      scale_down_schedule_expression          = optional(string, "cron(<em>/5 * * * ? </em>)")<br/>      scale_up_reserved_concurrent_executions = optional(number, 1)<br/>      userdata_template                       = optional(string, null)<br/>      userdata_content                        = optional(string, null)<br/>      enable_jit_config                       = optional(bool, null)<br/>      enable_runner_detailed_monitoring       = optional(bool, false)<br/>      enable_cloudwatch_agent                 = optional(bool, true)<br/>      cloudwatch_config                       = optional(string, null)<br/>      userdata_pre_install                    = optional(string, "")<br/>      userdata_post_install                   = optional(string, "")<br/>      runner_hook_job_started                 = optional(string, "")<br/>      runner_hook_job_completed               = optional(string, "")<br/>      runner_ec2_tags                         = optional(map(string), {})<br/>      runner_iam_role_managed_policy_arns     = optional(list(string), [])<br/>      vpc_id                                  = optional(string, null)<br/>      subnet_ids                              = optional(list(string), null)<br/>      idle_config = optional(list(object({<br/>        cron             = string<br/>        timeZone         = string<br/>        idleCount        = number<br/>        evictionStrategy = optional(string, "oldest_first")<br/>      })), [])<br/>      runner_log_files = optional(list(object({<br/>        log_group_name   = string<br/>        prefix_log_group = bool<br/>        file_path        = string<br/>        log_stream_name  = string<br/>      })), null)<br/>      block_device_mappings = optional(list(object({<br/>        delete_on_termination = optional(bool, true)<br/>        device_name           = optional(string, "/dev/xvda")<br/>        encrypted             = optional(bool, true)<br/>        iops                  = optional(number)<br/>        kms_key_id            = optional(string)<br/>        snapshot_id           = optional(string)<br/>        throughput            = optional(number)<br/>        volume_size           = number<br/>        volume_type           = optional(string, "gp3")<br/>        })), [{<br/>        volume_size = 30<br/>      }])<br/>      pool_config = optional(list(object({<br/>        schedule_expression          = string<br/>        schedule_expression_timezone = optional(string)<br/>        size                         = number<br/>      })), [])<br/>      job_retry = optional(object({<br/>        enable             = optional(bool, false)<br/>        delay_in_seconds   = optional(number, 300)<br/>        delay_backoff      = optional(number, 2)<br/>        lambda_memory_size = optional(number, 256)<br/>        lambda_timeout     = optional(number, 30)<br/>        max_attempts       = optional(number, 1)<br/>      }), {})<br/>    })<br/>    matcherConfig = object({<br/>      labelMatchers = list(list(string))<br/>      exactMatch    = optional(bool, false)<br/>      priority      = optional(number, 999)<br/>    })<br/>    redrive_build_queue = optional(object({<br/>      enabled         = bool<br/>      maxReceiveCount = number<br/>      }), {<br/>      enabled         = false<br/>      maxReceiveCount = null<br/>    })<br/>  }))</pre></td>
<td>n/a</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td><a name="input_pool_lambda_reserved_concurrent_executions"></a> <a href="#input_pool_lambda_reserved_concurrent_executions">pool_lambda_reserved_concurrent_executions</a></td>
<td>Amount of reserved concurrent executions for the scale-up lambda function. A value of 0 disables lambda from being triggered and -1 removes any concurrency limitations.</td>
<td><code>number</code></td>
<td><code>1</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_pool_lambda_timeout"></a> <a href="#input_pool_lambda_timeout">pool_lambda_timeout</a></td>
<td>Time out for the pool lambda in seconds.</td>
<td><code>number</code></td>
<td><code>60</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_prefix"></a> <a href="#input_prefix">prefix</a></td>
<td>The prefix used for naming resources</td>
<td><code>string</code></td>
<td><code>"github-actions"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_queue_encryption"></a> <a href="#input_queue_encryption">queue_encryption</a></td>
<td>Configure how data on queues managed by the modules in ecrypted at REST. Options are encryped via SSE, non encrypted and via KMSS. By default encryptes via SSE is enabled. See for more details the Terraform <code>aws_sqs_queue</code> resource https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue.</td>
<td><pre>object({<br/>    kms_data_key_reuse_period_seconds = number<br/>    kms_master_key_id                 = string<br/>    sqs_managed_sse_enabled           = bool<br/>  })</pre></td>
<td><pre>{<br/>  "kms_data_key_reuse_period_seconds": null,<br/>  "kms_master_key_id": null,<br/>  "sqs_managed_sse_enabled": true<br/>}</pre></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_repository_white_list"></a> <a href="#input_repository_white_list">repository_white_list</a></td>
<td>List of github repository full names (owner/repo_name) that will be allowed to use the github app. Leave empty for no filtering.</td>
<td><code>list(string)</code></td>
<td><code>[]</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_role_path"></a> <a href="#input_role_path">role_path</a></td>
<td>The path that will be added to the role; if not set, the environment name will be used.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_role_permissions_boundary"></a> <a href="#input_role_permissions_boundary">role_permissions_boundary</a></td>
<td>Permissions boundary that will be added to the created role for the lambda.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_additional_security_group_ids"></a> <a href="#input_runner_additional_security_group_ids">runner_additional_security_group_ids</a></td>
<td>(optional) List of additional security groups IDs to apply to the runner</td>
<td><code>list(string)</code></td>
<td><code>[]</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_binaries_s3_sse_configuration"></a> <a href="#input_runner_binaries_s3_sse_configuration">runner_binaries_s3_sse_configuration</a></td>
<td>Map containing server-side encryption configuration for runner-binaries S3 bucket.</td>
<td><code>any</code></td>
<td><pre>{<br/>  "rule": {<br/>    "apply_server_side_encryption_by_default": {<br/>      "sse_algorithm": "AES256"<br/>    }<br/>  }<br/>}</pre></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_binaries_s3_versioning"></a> <a href="#input_runner_binaries_s3_versioning">runner_binaries_s3_versioning</a></td>
<td>Status of S3 versioning for runner-binaries S3 bucket. Once set to Enabled the change cannot be reverted via Terraform!</td>
<td><code>string</code></td>
<td><code>"Disabled"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_binaries_syncer_lambda_timeout"></a> <a href="#input_runner_binaries_syncer_lambda_timeout">runner_binaries_syncer_lambda_timeout</a></td>
<td>Time out of the binaries sync lambda in seconds.</td>
<td><code>number</code></td>
<td><code>300</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_binaries_syncer_lambda_zip"></a> <a href="#input_runner_binaries_syncer_lambda_zip">runner_binaries_syncer_lambda_zip</a></td>
<td>File location of the binaries sync lambda zip file.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_binaries_syncer_memory_size"></a> <a href="#input_runner_binaries_syncer_memory_size">runner_binaries_syncer_memory_size</a></td>
<td>Memory size limit in MB for binary syncer lambda.</td>
<td><code>number</code></td>
<td><code>256</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runner_egress_rules"></a> <a href="#input_runner_egress_rules">runner_egress_rules</a></td>
<td>List of egress rules for the GitHub runner instances.</td>
<td><pre>list(object({<br/>    cidr_blocks      = list(string)<br/>    ipv6_cidr_blocks = list(string)<br/>    prefix_list_ids  = list(string)<br/>    from_port        = number<br/>    protocol         = string<br/>    security_groups  = list(string)<br/>    self             = bool<br/>    to_port          = number<br/>    description      = string<br/>  }))</pre></td>
<td><pre>[<br/>  {<br/>    "cidr_blocks": [<br/>      "0.0.0.0/0"<br/>    ],<br/>    "description": null,<br/>    "from_port": 0,<br/>    "ipv6_cidr_blocks": [<br/>      "::/0"<br/>    ],<br/>    "prefix_list_ids": null,<br/>    "protocol": "-1",<br/>    "security_groups": null,<br/>    "self": null,<br/>    "to_port": 0<br/>  }<br/>]</pre></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_lambda_s3_key"></a> <a href="#input_runners_lambda_s3_key">runners_lambda_s3_key</a></td>
<td>S3 key for runners lambda function. Required if using S3 bucket to specify lambdas.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_lambda_s3_object_version"></a> <a href="#input_runners_lambda_s3_object_version">runners_lambda_s3_object_version</a></td>
<td>S3 object version for runners lambda function. Useful if S3 versioning is enabled on source bucket.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_lambda_zip"></a> <a href="#input_runners_lambda_zip">runners_lambda_zip</a></td>
<td>File location of the lambda zip file for scaling runners.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_scale_down_lambda_timeout"></a> <a href="#input_runners_scale_down_lambda_timeout">runners_scale_down_lambda_timeout</a></td>
<td>Time out for the scale down lambda in seconds.</td>
<td><code>number</code></td>
<td><code>60</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_scale_up_lambda_timeout"></a> <a href="#input_runners_scale_up_lambda_timeout">runners_scale_up_lambda_timeout</a></td>
<td>Time out for the scale up lambda in seconds.</td>
<td><code>number</code></td>
<td><code>30</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_runners_ssm_housekeeper"></a> <a href="#input_runners_ssm_housekeeper">runners_ssm_housekeeper</a></td>
<td>Configuration for the SSM housekeeper lambda. This lambda deletes token / JIT config from SSM.<br/><br/>  <code>schedule_expression</code>: is used to configure the schedule for the lambda.<br/>  <code>enabled</code>: enable or disable the lambda trigger via the EventBridge.<br/>  <code>lambda_memory_size</code>: lambda memery size limit.<br/>  <code>lambda_timeout</code>: timeout for the lambda in seconds.<br/>  <code>config</code>: configuration for the lambda function. Token path will be read by default from the module.</td>
<td><pre>object({<br/>    schedule_expression = optional(string, "rate(1 day)")<br/>    enabled             = optional(bool, true)<br/>    lambda_memory_size  = optional(number, 512)<br/>    lambda_timeout      = optional(number, 60)<br/>    config = object({<br/>      tokenPath      = optional(string)<br/>      minimumDaysOld = optional(number, 1)<br/>      dryRun         = optional(bool, false)<br/>    })<br/>  })</pre></td>
<td><pre>{<br/>  "config": {}<br/>}</pre></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_scale_down_lambda_memory_size"></a> <a href="#input_scale_down_lambda_memory_size">scale_down_lambda_memory_size</a></td>
<td>Memory size limit in MB for scale down.</td>
<td><code>number</code></td>
<td><code>512</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_scale_up_lambda_memory_size"></a> <a href="#input_scale_up_lambda_memory_size">scale_up_lambda_memory_size</a></td>
<td>Memory size limit in MB for scale_up lambda.</td>
<td><code>number</code></td>
<td><code>512</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_ssm_paths"></a> <a href="#input_ssm_paths">ssm_paths</a></td>
<td>The root path used in SSM to store configuration and secreets.</td>
<td><pre>object({<br/>    root    = optional(string, "github-action-runners")<br/>    app     = optional(string, "app")<br/>    runners = optional(string, "runners")<br/>    webhook = optional(string, "webhook")<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_state_event_rule_binaries_syncer"></a> <a href="#input_state_event_rule_binaries_syncer">state_event_rule_binaries_syncer</a></td>
<td>Option to disable EventBridge Lambda trigger for the binary syncer, useful to stop automatic updates of binary distribution</td>
<td><code>string</code></td>
<td><code>"ENABLED"</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_subnet_ids"></a> <a href="#input_subnet_ids">subnet_ids</a></td>
<td>List of subnets in which the action runners will be launched, the subnets needs to be subnets in the <code>vpc_id</code>.</td>
<td><code>list(string)</code></td>
<td>n/a</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td><a name="input_syncer_lambda_s3_key"></a> <a href="#input_syncer_lambda_s3_key">syncer_lambda_s3_key</a></td>
<td>S3 key for syncer lambda function. Required if using S3 bucket to specify lambdas.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_syncer_lambda_s3_object_version"></a> <a href="#input_syncer_lambda_s3_object_version">syncer_lambda_s3_object_version</a></td>
<td>S3 object version for syncer lambda function. Useful if S3 versioning is enabled on source bucket.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_tags"></a> <a href="#input_tags">tags</a></td>
<td>Map of tags that will be added to created resources. By default resources will be tagged with name and environment.</td>
<td><code>map(string)</code></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_tracing_config"></a> <a href="#input_tracing_config">tracing_config</a></td>
<td>Configuration for lambda tracing.</td>
<td><pre>object({<br/>    mode                  = optional(string, null)<br/>    capture_http_requests = optional(bool, false)<br/>    capture_error         = optional(bool, false)<br/>  })</pre></td>
<td><code>{}</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_vpc_id"></a> <a href="#input_vpc_id">vpc_id</a></td>
<td>The VPC for security groups of the action runners.</td>
<td><code>string</code></td>
<td>n/a</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_apigateway_access_log_settings"></a> <a href="#input_webhook_lambda_apigateway_access_log_settings">webhook_lambda_apigateway_access_log_settings</a></td>
<td>Access log settings for webhook API gateway.</td>
<td><pre>object({<br/>    destination_arn = string<br/>    format          = string<br/>  })</pre></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_memory_size"></a> <a href="#input_webhook_lambda_memory_size">webhook_lambda_memory_size</a></td>
<td>Memory size limit in MB for webhook lambda.</td>
<td><code>number</code></td>
<td><code>256</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_s3_key"></a> <a href="#input_webhook_lambda_s3_key">webhook_lambda_s3_key</a></td>
<td>S3 key for webhook lambda function. Required if using S3 bucket to specify lambdas.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_s3_object_version"></a> <a href="#input_webhook_lambda_s3_object_version">webhook_lambda_s3_object_version</a></td>
<td>S3 object version for webhook lambda function. Useful if S3 versioning is enabled on source bucket.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_timeout"></a> <a href="#input_webhook_lambda_timeout">webhook_lambda_timeout</a></td>
<td>Time out of the lambda in seconds.</td>
<td><code>number</code></td>
<td><code>10</code></td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td><a name="input_webhook_lambda_zip"></a> <a href="#input_webhook_lambda_zip">webhook_lambda_zip</a></td>
<td>File location of the webhook lambda zip file.</td>
<td><code>string</code></td>
<td><code>null</code></td>
<td style="text-align: center;">no</td>
</tr>
</tbody>
</table>
<h2 id="outputs">Outputs</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a name="output_binaries_syncer_map"></a> <a href="#output_binaries_syncer_map">binaries_syncer_map</a></td>
<td>n/a</td>
</tr>
<tr>
<td><a name="output_instance_termination_handler"></a> <a href="#output_instance_termination_handler">instance_termination_handler</a></td>
<td>n/a</td>
</tr>
<tr>
<td><a name="output_instance_termination_watcher"></a> <a href="#output_instance_termination_watcher">instance_termination_watcher</a></td>
<td>n/a</td>
</tr>
<tr>
<td><a name="output_runners_map"></a> <a href="#output_runners_map">runners_map</a></td>
<td>n/a</td>
</tr>
<tr>
<td><a name="output_ssm_parameters"></a> <a href="#output_ssm_parameters">ssm_parameters</a></td>
<td>n/a</td>
</tr>
<tr>
<td><a name="output_webhook"></a> <a href="#output_webhook">webhook</a></td>
<td>n/a</td>
</tr>
</tbody>
</table>
<!-- END_TF_DOCS -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../runners/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Runners (main)">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Runners (main)
              </div>
            </div>
          </a>
        
        
          
          <a href="../ami-housekeeper/" class="md-footer__link md-footer__link--next" aria-label="Next: AMI Housekeeper">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                AMI Housekeeper
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/github-aws-runners/terraform-aws-github-runner" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.action.edit", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "pymdownx.snippets", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>